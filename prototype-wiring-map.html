<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Prototype Wiring Map — Sell & Rebalance Tool v4</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=DM+Mono:wght@400;500&family=DM+Sans:wght@400;500;700&display=swap');

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:        #0e0f11;
  --surface:   #16181c;
  --surface2:  #1e2026;
  --border:    #2a2d35;
  --border2:   #383c47;

  --wf-a:      #2f7de1;
  --wf-a-dim:  #1a3f70;
  --wf-a-glow: rgba(47,125,225,0.18);
  --wf-b:      #18b589;
  --wf-b-dim:  #0d5c44;
  --wf-b-glow: rgba(24,181,137,0.18);
  --wf-x:      #9b72e8;   /* cross-workflow */
  --wf-x-dim:  #4a2d80;
  --wf-x-glow: rgba(155,114,232,0.18);
  --warn:      #e07b00;
  --warn-dim:  #6b3b00;
  --warn-glow: rgba(224,123,0,0.18);
  --confirm:   #3aaa5c;
  --confirm-dim: #1a5530;

  --text:      #f0f1f3;
  --text-mid:  #9aa0ae;
  --text-dim:  #555b68;

  --mono: 'DM Mono', monospace;
  --sans: 'DM Sans', sans-serif;
}

body {
  font-family: var(--sans);
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  padding: 40px 48px 80px;
}

/* ── HEADER ── */
.hdr {
  margin-bottom: 44px;
}
.hdr-eyebrow {
  font-family: var(--mono);
  font-size: 10px;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 8px;
}
.hdr-title {
  font-size: 22px;
  font-weight: 700;
  letter-spacing: -0.02em;
  margin-bottom: 6px;
}
.hdr-sub {
  font-size: 13px;
  color: var(--text-mid);
}

/* ── LEGEND ── */
.legend {
  display: flex;
  flex-wrap: wrap;
  gap: 6px 20px;
  margin-bottom: 40px;
  padding: 14px 18px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
}
.leg {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 11px;
  color: var(--text-mid);
}
.leg-line {
  width: 28px; height: 2px;
  border-radius: 1px;
  flex-shrink: 0;
}
.leg-line.dashed {
  background: repeating-linear-gradient(90deg,currentColor 0,currentColor 4px,transparent 4px,transparent 8px);
  height: 0;
  border-top: 2px dashed currentColor;
}
.leg-dot {
  width: 10px; height: 10px;
  border-radius: 50%;
  flex-shrink: 0;
}

/* ── MAIN CANVAS ── */
.canvas {
  display: grid;
  grid-template-columns: 1fr;
  gap: 0;
  position: relative;
}

/* ── ROW / ZONE ── */
.zone {
  margin-bottom: 12px;
}
.zone-label {
  font-family: var(--mono);
  font-size: 9px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.zone-label::after {
  content: '';
  flex: 1;
  height: 1px;
  background: var(--border);
}

/* ── SCREEN ROW ── */
.screen-row {
  display: flex;
  align-items: flex-start;
  gap: 0;
  position: relative;
}

/* ── SCREEN NODE ── */
.sn {
  flex: 0 0 auto;
  width: 148px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  overflow: hidden;
  position: relative;
  transition: border-color 0.15s;
}
.sn:hover { border-color: var(--border2); }

.sn-head {
  padding: 8px 10px 7px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 7px;
}
.sn-num {
  width: 18px; height: 18px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-family: var(--mono);
  font-size: 9px;
  font-weight: 500;
  flex-shrink: 0;
}
.sn-title {
  font-size: 10px;
  font-weight: 700;
  line-height: 1.3;
  color: var(--text);
}
.sn-body {
  padding: 8px 10px;
}
.sn-wf {
  font-family: var(--mono);
  font-size: 8px;
  color: var(--text-dim);
  margin-bottom: 6px;
  letter-spacing: 0.04em;
}
.sn-triggers {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

/* ── TRIGGER CHIP ── */
.tc {
  display: flex;
  align-items: center;
  gap: 5px;
  padding: 3px 7px 3px 5px;
  border-radius: 100px;
  font-size: 9px;
  font-weight: 500;
  border: 1px solid;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}
.tc-icon {
  flex-shrink: 0;
  font-size: 8px;
}
.tc-label {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-family: var(--mono);
  font-size: 8px;
}

/* Workflow colour variants */
.tc-a    { background: var(--wf-a-glow);  border-color: var(--wf-a-dim);  color: #7ab6f5; }
.tc-b    { background: var(--wf-b-glow);  border-color: var(--wf-b-dim);  color: #6de0b9; }
.tc-x    { background: var(--wf-x-glow);  border-color: var(--wf-x-dim);  color: #c4a8f7; }
.tc-warn { background: var(--warn-glow);  border-color: var(--warn-dim);  color: #f0b060; }
.tc-conf { background: rgba(58,170,92,0.15); border-color: #1a5530; color: #72dfa0; }
.tc-back { background: rgba(255,255,255,0.04); border-color: var(--border); color: var(--text-mid); }
.tc-tog  { background: rgba(47,125,225,0.08); border-color: var(--wf-a-dim); color: #7ab6f5; border-style: dashed; }

/* ── SCREEN COLOUR THEMES ── */
.s-entry  .sn-num { background: #2a2d35; color: var(--text-mid); }
.s-entry  .sn-head { border-left: 3px solid #555b68; }

.s-wfa   .sn-num { background: var(--wf-a-dim); color: #7ab6f5; }
.s-wfa   .sn-head { border-left: 3px solid var(--wf-a); }

.s-wfb   .sn-num { background: var(--wf-b-dim); color: #6de0b9; }
.s-wfb   .sn-head { border-left: 3px solid var(--wf-b); }

.s-both  .sn-num { background: var(--wf-x-dim); color: #c4a8f7; }
.s-both  .sn-head { border-left: 3px solid var(--wf-x); }

.s-warn  .sn-num { background: var(--warn-dim); color: #f0b060; }
.s-warn  .sn-head { border-left: 3px solid var(--warn); }

.s-conf-a .sn-num { background: var(--confirm-dim); color: #72dfa0; }
.s-conf-a .sn-head { border-left: 3px solid var(--confirm); }

.s-conf-b .sn-num { background: #1a4a30; color: #72dfa0; }
.s-conf-b .sn-head { border-left: 3px solid #2a8a58; }

/* ── CONNECTOR COLUMN ── */
.conn-col {
  flex: 1;
  min-width: 32px;
  position: relative;
  align-self: stretch;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ── SVG OVERLAY for arrows ── */
.wiring-svg {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  overflow: visible;
}

/* ── WIRING TABLE ── */
.wiring-table-wrap {
  margin-top: 48px;
}
.wiring-table-title {
  font-family: var(--mono);
  font-size: 10px;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-bottom: 14px;
  display: flex; align-items: center; gap: 10px;
}
.wiring-table-title::after {
  content: ''; flex: 1; height: 1px; background: var(--border);
}

table.wt {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}
table.wt th {
  font-family: var(--mono);
  font-size: 9px;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--text-dim);
  padding: 6px 14px;
  text-align: left;
  border-bottom: 1px solid var(--border);
  background: var(--surface);
}
table.wt td {
  padding: 9px 14px;
  border-bottom: 1px solid var(--border);
  color: var(--text-mid);
  vertical-align: middle;
}
table.wt tr:last-child td { border-bottom: none; }
table.wt tr:hover td { background: var(--surface); }

.wt-from { font-weight: 700; color: var(--text); font-family: var(--mono); font-size: 11px; }
.wt-trigger { color: var(--text); }
.wt-to { font-weight: 700; font-family: var(--mono); font-size: 11px; }

.pip {
  display: inline-block;
  width: 8px; height: 8px;
  border-radius: 50%;
  margin-right: 5px;
  vertical-align: middle;
  flex-shrink: 0;
}

/* flow color classes for table rows */
.row-a  td { border-left: 2px solid var(--wf-a); }
.row-b  td { border-left: 2px solid var(--wf-b); }
.row-x  td { border-left: 2px solid var(--wf-x); }
.row-w  td { border-left: 2px solid var(--warn); }
.row-back td { border-left: 2px solid var(--border2); }

/* ── FLOW COUNT BADGE ── */
.flow-count {
  display: inline-flex; align-items: center; justify-content: center;
  width: 20px; height: 20px; border-radius: 50%;
  font-size: 10px; font-weight: 700;
  font-family: var(--mono);
  margin-right: 4px;
}

/* ── NAMED FLOW PILLS ── */
.named-flows {
  display: flex; flex-wrap: wrap; gap: 8px;
  margin-bottom: 36px;
}
.nf {
  display: flex; align-items: center; gap: 8px;
  padding: 8px 14px;
  border-radius: 8px;
  border: 1px solid;
  font-size: 11px;
}
.nf-label { font-weight: 700; }
.nf-path {
  font-family: var(--mono);
  font-size: 10px;
  opacity: 0.8;
}
.nf-a { background: var(--wf-a-glow); border-color: var(--wf-a-dim); color: #7ab6f5; }
.nf-b { background: var(--wf-b-glow); border-color: var(--wf-b-dim); color: #6de0b9; }

/* ── DIAGRAM LAYOUT ── */
.diagram {
  position: relative;
  /* We'll use a CSS grid flow */
}

/* Row layouts */
.row-1col { display: flex; justify-content: center; margin-bottom: 0; }
.row-3col { display: flex; justify-content: space-around; margin-bottom: 0; }
.row-2col { display: flex; justify-content: center; gap: 80px; margin-bottom: 0; }
.row-4col { display: flex; justify-content: space-around; margin-bottom: 0; }

/* Vertical spacers */
.v-gap-sm { height: 20px; }
.v-gap-md { height: 36px; }
.v-gap-lg { height: 48px; }

/* ── ARROW SVG CONTAINER ── */
.arrows-layer {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
}

/* ── INLINE ARROW (between nodes in same row) ── */
.row-connector {
  display: flex; align-items: center; gap: 0;
}
.arrow-seg {
  display: flex; align-items: center;
  font-size: 8px;
  color: var(--text-dim);
  padding: 0 4px;
  flex-shrink: 0;
}
.arrow-seg .arr-line {
  height: 1.5px;
  background: currentColor;
  min-width: 20px;
}
.arrow-seg .arr-head { flex-shrink: 0; }

/* Override for positioned diagram */
.sn { position: relative; z-index: 2; }

/* ── COMPACT NODE (for table view) ── */
.sn-compact {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 4px 10px 4px 6px;
  border-radius: 100px;
  border: 1px solid;
  font-size: 11px;
  font-weight: 700;
  font-family: var(--mono);
}
</style>
</head>
<body>

<div class="hdr">
  <div class="hdr-eyebrow">Sell &amp; Rebalance Tool &nbsp;·&nbsp; Hi-Fi Wireframes v4 &nbsp;·&nbsp; 10 Screens</div>
  <div class="hdr-title">Prototype Wiring Map</div>
  <div class="hdr-sub">All screen transitions · trigger elements · named flows · February 2026</div>
</div>

<!-- ── LEGEND ── -->
<div class="legend">
  <div class="leg"><div class="leg-line" style="background:var(--wf-a);"></div> Workflow A — Automated</div>
  <div class="leg"><div class="leg-line" style="background:var(--wf-b);"></div> Workflow B — Manual</div>
  <div class="leg"><div class="leg-line" style="background:var(--wf-x);"></div> Cross-workflow / bidirectional</div>
  <div class="leg"><div class="leg-line" style="background:var(--warn);"></div> Wait &amp; Save interrupt path</div>
  <div class="leg"><div class="leg-line" style="background:var(--confirm);"></div> Execute → Confirmation</div>
  <div class="leg"><div class="leg-line dashed" style="color:var(--border2);"></div> Back / return navigation</div>
</div>

<!-- ── NAMED FLOWS ── -->
<div class="wiring-table-title" style="margin-bottom:12px;">Named Flows (Figma Prototype Panel)</div>
<div class="named-flows">
  <div class="nf nf-a">
    <span class="flow-count" style="background:var(--wf-a-dim);color:#7ab6f5;">A</span>
    <span class="nf-label">Workflow A — Automated</span>
    <span class="nf-path">S0 → S1 → S4 → S8</span>
  </div>
  <div class="nf nf-a" style="opacity:0.75;">
    <span class="flow-count" style="background:var(--wf-a-dim);color:#7ab6f5;">A+</span>
    <span class="nf-label">Workflow A with Comparison</span>
    <span class="nf-path">S0 → S1 → S4 → S6 → S8</span>
  </div>
  <div class="nf nf-b">
    <span class="flow-count" style="background:var(--wf-b-dim);color:#6de0b9;">B</span>
    <span class="nf-label">Workflow B — Manual</span>
    <span class="nf-path">S0 → S2 → S5 → S9</span>
  </div>
  <div class="nf nf-b" style="opacity:0.75;">
    <span class="flow-count" style="background:var(--wf-b-dim);color:#6de0b9;">B+</span>
    <span class="nf-label">Workflow B with Comparison</span>
    <span class="nf-path">S0 → S2 → S5 → S6 → S9</span>
  </div>
  <div class="nf" style="background:var(--warn-glow);border-color:var(--warn-dim);color:#f0b060;">
    <span class="flow-count" style="background:var(--warn-dim);color:#f0b060;">W</span>
    <span class="nf-label">Wait &amp; Save Interrupt</span>
    <span class="nf-path">S2 (badge) → S7 → S5</span>
  </div>
</div>

<!-- ══════════════════════════════════════════
     WIRING REFERENCE TABLE
══════════════════════════════════════════ -->
<div class="wiring-table-title">All Connections — 22 Wires</div>
<table class="wt">
  <thead>
    <tr>
      <th style="width:60px;">#</th>
      <th style="width:200px;">From</th>
      <th>Trigger element</th>
      <th style="width:220px;">To</th>
      <th style="width:80px;">Flow</th>
    </tr>
  </thead>
  <tbody>

    <!-- ── ENTRY POINT ── -->
    <tr class="row-a">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">01</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--text-mid);"></span>S0 · Portfolio Balances</td>
      <td class="wt-trigger">"Sell from this account" hover button (any account row)</td>
      <td class="wt-to" style="color:#7ab6f5;"><span class="pip" style="background:var(--wf-a);"></span>S1 · Fund List Auto</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#7ab6f5;">Wf-A</span></td>
    </tr>

    <!-- ── FUND LIST AUTO (S1) ── -->
    <tr class="row-a">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">02</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-a);"></span>S1 · Fund List Auto</td>
      <td class="wt-trigger">"Analyze Scenarios →" footer button</td>
      <td class="wt-to" style="color:#7ab6f5;"><span class="pip" style="background:var(--wf-a);"></span>S4 · Scenario Analysis Wf-A</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#7ab6f5;">Wf-A</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">03</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-a);"></span>S1 · Fund List Auto</td>
      <td class="wt-trigger">"Manual" toggle (Auto/Manual switch)</td>
      <td class="wt-to" style="color:#6de0b9;"><span class="pip" style="background:var(--wf-b);"></span>S2 · Fund List Manual Table</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-back">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">04</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-a);"></span>S1 · Fund List Auto</td>
      <td class="wt-trigger">"Back to Balances" link</td>
      <td class="wt-to" style="color:var(--text-mid);"><span class="pip" style="background:var(--text-dim);"></span>S0 · Portfolio Balances</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:var(--text-dim);">Back</span></td>
    </tr>

    <!-- ── FUND LIST MANUAL TABLE (S2) ── -->
    <tr class="row-b">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">05</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S2 · Fund List Manual Table</td>
      <td class="wt-trigger">"Analyze Scenario →" footer button</td>
      <td class="wt-to" style="color:#6de0b9;"><span class="pip" style="background:var(--wf-b);"></span>S5 · Scenario Analysis Wf-B</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#6de0b9;">Wf-B</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">06</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S2 · Fund List Manual Table</td>
      <td class="wt-trigger">"Auto" toggle (Auto/Manual switch)</td>
      <td class="wt-to" style="color:#7ab6f5;"><span class="pip" style="background:var(--wf-a);"></span>S1 · Fund List Auto</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">07</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S2 · Fund List Manual Table</td>
      <td class="wt-trigger">"Cards" view toggle</td>
      <td class="wt-to" style="color:#6de0b9;"><span class="pip" style="background:var(--wf-b);"></span>S3 · Fund List Manual Cards</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-w">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">08</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S2 · Fund List Manual Table</td>
      <td class="wt-trigger">⏱ WAIT &amp; SAVE badge (VFIAX row)</td>
      <td class="wt-to" style="color:#f0b060;"><span class="pip" style="background:var(--warn);"></span>S7 · Wait &amp; Save Alert</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#f0b060;">Warn</span></td>
    </tr>

    <!-- ── FUND LIST MANUAL CARDS (S3) ── -->
    <tr class="row-b">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">09</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S3 · Fund List Manual Cards</td>
      <td class="wt-trigger">"Analyze Scenario →" footer button</td>
      <td class="wt-to" style="color:#6de0b9;"><span class="pip" style="background:var(--wf-b);"></span>S5 · Scenario Analysis Wf-B</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#6de0b9;">Wf-B</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">10</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S3 · Fund List Manual Cards</td>
      <td class="wt-trigger">"Table" view toggle</td>
      <td class="wt-to" style="color:#6de0b9;"><span class="pip" style="background:var(--wf-b);"></span>S2 · Fund List Manual Table</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-w">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">11</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S3 · Fund List Manual Cards</td>
      <td class="wt-trigger">⏱ WAIT &amp; SAVE badge (VFIAX card header)</td>
      <td class="wt-to" style="color:#f0b060;"><span class="pip" style="background:var(--warn);"></span>S7 · Wait &amp; Save Alert</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#f0b060;">Warn</span></td>
    </tr>

    <!-- ── SCENARIO ANALYSIS Wf-A (S4) ── -->
    <tr class="row-a">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">12</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-a);"></span>S4 · Scenario Analysis Wf-A</td>
      <td class="wt-trigger">"Execute Scenario A" footer button</td>
      <td class="wt-to" style="color:#72dfa0;"><span class="pip" style="background:var(--confirm);"></span>S8 · Confirmation Wf-A</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#7ab6f5;">Wf-A</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">13</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-a);"></span>S4 · Scenario Analysis Wf-A</td>
      <td class="wt-trigger">"+ Add Scenario" column button</td>
      <td class="wt-to" style="color:#c4a8f7;"><span class="pip" style="background:var(--wf-x);"></span>S6 · Scenario Comparison</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-back">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">14</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-a);"></span>S4 · Scenario Analysis Wf-A</td>
      <td class="wt-trigger">"Back to Fund List" link</td>
      <td class="wt-to" style="color:var(--text-mid);"><span class="pip" style="background:var(--text-dim);"></span>S1 · Fund List Auto</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:var(--text-dim);">Back</span></td>
    </tr>

    <!-- ── SCENARIO ANALYSIS Wf-B (S5) ── -->
    <tr class="row-b">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">15</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S5 · Scenario Analysis Wf-B</td>
      <td class="wt-trigger">"Execute Scenario A" footer button</td>
      <td class="wt-to" style="color:#72dfa0;"><span class="pip" style="background:#2a8a58;"></span>S9 · Confirmation Wf-B</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#6de0b9;">Wf-B</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">16</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S5 · Scenario Analysis Wf-B</td>
      <td class="wt-trigger">"+ Add Scenario" column button</td>
      <td class="wt-to" style="color:#c4a8f7;"><span class="pip" style="background:var(--wf-x);"></span>S6 · Scenario Comparison</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">17</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S5 · Scenario Analysis Wf-B</td>
      <td class="wt-trigger">"See engine recommendation →" link (inline tip)</td>
      <td class="wt-to" style="color:#7ab6f5;"><span class="pip" style="background:var(--wf-a);"></span>S4 · Scenario Analysis Wf-A</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-back">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">18</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-b);"></span>S5 · Scenario Analysis Wf-B</td>
      <td class="wt-trigger">"Back to Fund List" link</td>
      <td class="wt-to" style="color:var(--text-mid);"><span class="pip" style="background:var(--text-dim);"></span>S2 · Fund List Manual Table</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:var(--text-dim);">Back</span></td>
    </tr>

    <!-- ── SCENARIO COMPARISON (S6) ── -->
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">19</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-x);"></span>S6 · Scenario Comparison</td>
      <td class="wt-trigger">"Execute Scenario A" footer button (saves $582)</td>
      <td class="wt-to" style="color:#72dfa0;"><span class="pip" style="background:var(--confirm);"></span>S8 · Confirmation Wf-A</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>
    <tr class="row-x">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">20</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--wf-x);"></span>S6 · Scenario Comparison</td>
      <td class="wt-trigger">"Execute Scenario B" footer button</td>
      <td class="wt-to" style="color:#72dfa0;"><span class="pip" style="background:#2a8a58;"></span>S9 · Confirmation Wf-B</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#c4a8f7;">Cross</span></td>
    </tr>

    <!-- ── WAIT & SAVE (S7) ── -->
    <tr class="row-w">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">21</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--warn);"></span>S7 · Wait &amp; Save Alert</td>
      <td class="wt-trigger">"Proceed anyway" or "Remind me in 60 days" or ✕ dismiss</td>
      <td class="wt-to" style="color:#6de0b9;"><span class="pip" style="background:var(--wf-b);"></span>S5 · Scenario Analysis Wf-B</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#f0b060;">Warn</span></td>
    </tr>
    <tr class="row-w">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">22</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--warn);"></span>S7 · Wait &amp; Save Alert</td>
      <td class="wt-trigger">"Adjust sale to avoid these lots"</td>
      <td class="wt-to" style="color:#6de0b9;"><span class="pip" style="background:var(--wf-b);"></span>S2 · Fund List Manual Table</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:#f0b060;">Warn</span></td>
    </tr>

    <!-- ── CONFIRMATION SCREENS ── -->
    <tr class="row-back">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">23</span></td>
      <td class="wt-from"><span class="pip" style="background:var(--confirm);"></span>S8 · Confirmation Wf-A</td>
      <td class="wt-trigger">"Return to Portfolio" button</td>
      <td class="wt-to" style="color:var(--text-mid);"><span class="pip" style="background:var(--text-dim);"></span>S0 · Portfolio Balances</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:var(--text-dim);">Back</span></td>
    </tr>
    <tr class="row-back">
      <td><span style="font-family:var(--mono);font-size:10px;color:var(--text-dim);">24</span></td>
      <td class="wt-from"><span class="pip" style="background:#2a8a58;"></span>S9 · Confirmation Wf-B</td>
      <td class="wt-trigger">"Return to Portfolio" button</td>
      <td class="wt-to" style="color:var(--text-mid);"><span class="pip" style="background:var(--text-dim);"></span>S0 · Portfolio Balances</td>
      <td><span style="font-family:var(--mono);font-size:9px;color:var(--text-dim);">Back</span></td>
    </tr>

  </tbody>
</table>

<!-- ── VISUAL FLOW DIAGRAM ── -->
<div class="wiring-table-title" style="margin-top:56px;">Visual Flow</div>

<div style="background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:36px 32px 40px;overflow-x:auto;">

  <!-- Use SVG for the whole flow diagram -->
  <svg viewBox="0 0 900 680" width="100%" style="max-width:900px;display:block;margin:0 auto;font-family:'DM Sans',sans-serif;">

    <!-- ── DEFS ── -->
    <defs>
      <marker id="arr-a" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto">
        <polygon points="0 0, 7 3.5, 0 7" fill="#2f7de1"/>
      </marker>
      <marker id="arr-b" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto">
        <polygon points="0 0, 7 3.5, 0 7" fill="#18b589"/>
      </marker>
      <marker id="arr-x" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto">
        <polygon points="0 0, 7 3.5, 0 7" fill="#9b72e8"/>
      </marker>
      <marker id="arr-w" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto">
        <polygon points="0 0, 7 3.5, 0 7" fill="#e07b00"/>
      </marker>
      <marker id="arr-c" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto">
        <polygon points="0 0, 7 3.5, 0 7" fill="#3aaa5c"/>
      </marker>
      <marker id="arr-back" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto">
        <polygon points="0 0, 7 3.5, 0 7" fill="#383c47"/>
      </marker>
    </defs>

    <!-- ─────────────────── SCREEN NODES ─────────────────── -->

    <!-- S0 — centre top -->
    <!-- x=375, y=50, w=150, h=52 -->
    <rect x="375" y="50" width="150" height="52" rx="6" fill="#1e2026" stroke="#555b68" stroke-width="1.5"/>
    <rect x="375" y="50" width="4" height="52" rx="2" fill="#555b68"/>
    <circle cx="391" cy="76" r="9" fill="#2a2d35"/>
    <text x="391" y="79.5" text-anchor="middle" fill="#9aa0ae" font-size="9" font-family="'DM Mono',monospace" font-weight="500">0</text>
    <text x="406" y="71" fill="#f0f1f3" font-size="10" font-weight="700">S0</text>
    <text x="406" y="84" fill="#9aa0ae" font-size="9">Portfolio Balances</text>

    <!-- S1 — Wf-A, left -->
    <!-- x=60, y=130, w=158, h=52 -->
    <rect x="60" y="130" width="158" height="52" rx="6" fill="#1e2026" stroke="#1a3f70" stroke-width="1.5"/>
    <rect x="60" y="130" width="4" height="52" rx="2" fill="#2f7de1"/>
    <circle cx="77" cy="156" r="9" fill="#1a3f70"/>
    <text x="77" y="159.5" text-anchor="middle" fill="#7ab6f5" font-size="9" font-family="'DM Mono',monospace" font-weight="500">1</text>
    <text x="92" y="151" fill="#f0f1f3" font-size="10" font-weight="700">S1</text>
    <text x="92" y="164" fill="#9aa0ae" font-size="9">Fund List Auto (Wf-A)</text>

    <!-- S2 — Wf-B, centre -->
    <!-- x=371, y=130, w=158, h=52 -->
    <rect x="371" y="130" width="158" height="52" rx="6" fill="#1e2026" stroke="#0d5c44" stroke-width="1.5"/>
    <rect x="371" y="130" width="4" height="52" rx="2" fill="#18b589"/>
    <circle cx="388" cy="156" r="9" fill="#0d5c44"/>
    <text x="388" y="159.5" text-anchor="middle" fill="#6de0b9" font-size="9" font-family="'DM Mono',monospace" font-weight="500">2</text>
    <text x="403" y="151" fill="#f0f1f3" font-size="10" font-weight="700">S2</text>
    <text x="403" y="164" fill="#9aa0ae" font-size="9">Manual Table (Wf-B)</text>

    <!-- S3 — Wf-B, right -->
    <!-- x=682, y=130, w=158, h=52 -->
    <rect x="682" y="130" width="158" height="52" rx="6" fill="#1e2026" stroke="#0d5c44" stroke-width="1.5"/>
    <rect x="682" y="130" width="4" height="52" rx="2" fill="#18b589"/>
    <circle cx="699" cy="156" r="9" fill="#0d5c44"/>
    <text x="699" y="159.5" text-anchor="middle" fill="#6de0b9" font-size="9" font-family="'DM Mono',monospace" font-weight="500">3</text>
    <text x="714" y="151" fill="#f0f1f3" font-size="10" font-weight="700">S3</text>
    <text x="714" y="164" fill="#9aa0ae" font-size="9">Manual Cards (Wf-B)</text>

    <!-- S7 — Wait & Save, far right -->
    <!-- x=682, y=270, w=158, h=52 -->
    <rect x="682" y="265" width="158" height="52" rx="6" fill="#1e2026" stroke="#6b3b00" stroke-width="1.5"/>
    <rect x="682" y="265" width="4" height="52" rx="2" fill="#e07b00"/>
    <circle cx="699" cy="291" r="9" fill="#6b3b00"/>
    <text x="699" y="294.5" text-anchor="middle" fill="#f0b060" font-size="9" font-family="'DM Mono',monospace" font-weight="500">7</text>
    <text x="714" y="286" fill="#f0f1f3" font-size="10" font-weight="700">S7</text>
    <text x="714" y="299" fill="#9aa0ae" font-size="9">Wait &amp; Save Alert</text>

    <!-- S4 — Scenario Wf-A, left -->
    <!-- x=60, y=270, w=158, h=52 -->
    <rect x="60" y="265" width="158" height="52" rx="6" fill="#1e2026" stroke="#1a3f70" stroke-width="1.5"/>
    <rect x="60" y="265" width="4" height="52" rx="2" fill="#2f7de1"/>
    <circle cx="77" cy="291" r="9" fill="#1a3f70"/>
    <text x="77" y="294.5" text-anchor="middle" fill="#7ab6f5" font-size="9" font-family="'DM Mono',monospace" font-weight="500">4</text>
    <text x="92" y="286" fill="#f0f1f3" font-size="10" font-weight="700">S4</text>
    <text x="92" y="299" fill="#9aa0ae" font-size="9">Scenario Analysis Wf-A</text>

    <!-- S5 — Scenario Wf-B, centre -->
    <!-- x=371, y=270, w=158, h=52 -->
    <rect x="371" y="265" width="158" height="52" rx="6" fill="#1e2026" stroke="#0d5c44" stroke-width="1.5"/>
    <rect x="371" y="265" width="4" height="52" rx="2" fill="#18b589"/>
    <circle cx="388" cy="291" r="9" fill="#0d5c44"/>
    <text x="388" y="294.5" text-anchor="middle" fill="#6de0b9" font-size="9" font-family="'DM Mono',monospace" font-weight="500">5</text>
    <text x="403" y="286" fill="#f0f1f3" font-size="10" font-weight="700">S5</text>
    <text x="403" y="299" fill="#9aa0ae" font-size="9">Scenario Analysis Wf-B</text>

    <!-- S6 — Comparison, centre -->
    <!-- x=371, y=400, w=158, h=52 -->
    <rect x="371" y="400" width="158" height="52" rx="6" fill="#1e2026" stroke="#4a2d80" stroke-width="1.5"/>
    <rect x="371" y="400" width="4" height="52" rx="2" fill="#9b72e8"/>
    <circle cx="388" cy="426" r="9" fill="#4a2d80"/>
    <text x="388" y="429.5" text-anchor="middle" fill="#c4a8f7" font-size="9" font-family="'DM Mono',monospace" font-weight="500">6</text>
    <text x="403" y="421" fill="#f0f1f3" font-size="10" font-weight="700">S6</text>
    <text x="403" y="434" fill="#9aa0ae" font-size="9">Scenario Comparison</text>

    <!-- S8 — Confirmation Wf-A -->
    <!-- x=60, y=530, w=158, h=52 -->
    <rect x="60" y="530" width="158" height="52" rx="6" fill="#1e2026" stroke="#1a5530" stroke-width="1.5"/>
    <rect x="60" y="530" width="4" height="52" rx="2" fill="#3aaa5c"/>
    <circle cx="77" cy="556" r="9" fill="#1a5530"/>
    <text x="77" y="559.5" text-anchor="middle" fill="#72dfa0" font-size="9" font-family="'DM Mono',monospace" font-weight="500">8</text>
    <text x="92" y="551" fill="#f0f1f3" font-size="10" font-weight="700">S8</text>
    <text x="92" y="564" fill="#9aa0ae" font-size="9">Confirmation Wf-A</text>

    <!-- S9 — Confirmation Wf-B -->
    <!-- x=682, y=530, w=158, h=52 -->
    <rect x="682" y="530" width="158" height="52" rx="6" fill="#1e2026" stroke="#1a4a30" stroke-width="1.5"/>
    <rect x="682" y="530" width="4" height="52" rx="2" fill="#2a8a58"/>
    <circle cx="699" cy="556" r="9" fill="#1a4a30"/>
    <text x="699" y="559.5" text-anchor="middle" fill="#72dfa0" font-size="9" font-family="'DM Mono',monospace" font-weight="500">9</text>
    <text x="714" y="551" fill="#f0f1f3" font-size="10" font-weight="700">S9</text>
    <text x="714" y="564" fill="#9aa0ae" font-size="9">Confirmation Wf-B</text>

    <!-- ─────────────────── ARROWS ─────────────────── -->

    <!-- 01: S0 → S1 (Wf-A, "Sell from this account") -->
    <path d="M 450 102 L 450 120 L 139 120 L 139 130" stroke="#2f7de1" stroke-width="1.5" fill="none" marker-end="url(#arr-a)"/>
    <rect x="230" y="111" width="120" height="15" rx="3" fill="#0e0f11"/>
    <text x="290" y="122" text-anchor="middle" fill="#2f7de1" font-size="8.5" font-family="'DM Mono',monospace">Sell from this account</text>

    <!-- 02: S1 → S4 (Wf-A, "Analyze Scenarios") -->
    <path d="M 139 182 L 139 265" stroke="#2f7de1" stroke-width="1.5" fill="none" marker-end="url(#arr-a)"/>
    <rect x="48" y="216" width="104" height="15" rx="3" fill="#0e0f11"/>
    <text x="100" y="227" text-anchor="middle" fill="#2f7de1" font-size="8.5" font-family="'DM Mono',monospace">Analyze Scenarios →</text>

    <!-- 03: S1 ↔ S2 toggle (cross) -->
    <path d="M 218 148 L 371 148" stroke="#9b72e8" stroke-width="1.5" fill="none" marker-end="url(#arr-x)" stroke-dasharray="4,3"/>
    <path d="M 371 158 L 218 158" stroke="#9b72e8" stroke-width="1.5" fill="none" marker-end="url(#arr-x)" stroke-dasharray="4,3"/>
    <rect x="262" y="143" width="76" height="22" rx="3" fill="#0e0f11"/>
    <text x="300" y="151" text-anchor="middle" fill="#9b72e8" font-size="8" font-family="'DM Mono',monospace">Auto/Manual</text>
    <text x="300" y="161" text-anchor="middle" fill="#9b72e8" font-size="8" font-family="'DM Mono',monospace">toggle</text>

    <!-- 05: S2 → S5 (Wf-B, "Analyze Scenario") -->
    <path d="M 450 182 L 450 265" stroke="#18b589" stroke-width="1.5" fill="none" marker-end="url(#arr-b)"/>
    <rect x="340" y="216" width="120" height="15" rx="3" fill="#0e0f11"/>
    <text x="400" y="227" text-anchor="middle" fill="#18b589" font-size="8.5" font-family="'DM Mono',monospace">Analyze Scenario →</text>

    <!-- 07: S2 ↔ S3 table/cards toggle -->
    <path d="M 529 148 L 682 148" stroke="#9b72e8" stroke-width="1.5" fill="none" marker-end="url(#arr-x)" stroke-dasharray="4,3"/>
    <path d="M 682 158 L 529 158" stroke="#9b72e8" stroke-width="1.5" fill="none" marker-end="url(#arr-x)" stroke-dasharray="4,3"/>
    <rect x="570" y="143" width="72" height="22" rx="3" fill="#0e0f11"/>
    <text x="606" y="151" text-anchor="middle" fill="#9b72e8" font-size="8" font-family="'DM Mono',monospace">Table/Cards</text>
    <text x="606" y="161" text-anchor="middle" fill="#9b72e8" font-size="8" font-family="'DM Mono',monospace">toggle</text>

    <!-- 09: S3 → S5 (Wf-B, "Analyze Scenario") -->
    <path d="M 761 182 L 761 240 L 529 240 L 529 265" stroke="#18b589" stroke-width="1.5" fill="none" marker-end="url(#arr-b)"/>
    <rect x="590" y="231" width="120" height="15" rx="3" fill="#0e0f11"/>
    <text x="650" y="242" text-anchor="middle" fill="#18b589" font-size="8.5" font-family="'DM Mono',monospace">Analyze Scenario →</text>

    <!-- 08: S2 → S7 (Wait & Save badge) -->
    <path d="M 529 156 L 610 156 L 610 291 L 682 291" stroke="#e07b00" stroke-width="1.5" fill="none" marker-end="url(#arr-w)"/>
    <rect x="576" y="195" width="88" height="15" rx="3" fill="#0e0f11"/>
    <text x="620" y="206" text-anchor="middle" fill="#e07b00" font-size="8.5" font-family="'DM Mono',monospace">⏱ badge (S2)</text>

    <!-- 11: S3 → S7 (Wait & Save badge, S3) -->
    <path d="M 761 182 L 800 182 L 800 265" stroke="#e07b00" stroke-width="1.5" fill="none" marker-end="url(#arr-w)"/>
    <rect x="750" y="205" width="88" height="15" rx="3" fill="#0e0f11"/>
    <text x="794" y="216" text-anchor="middle" fill="#e07b00" font-size="8.5" font-family="'DM Mono',monospace">⏱ badge (S3)</text>

    <!-- 21: S7 → S5 (Proceed anyway) -->
    <path d="M 682 291 L 645 291 L 645 317 L 529 317" stroke="#e07b00" stroke-width="1.5" fill="none" marker-end="url(#arr-w)" stroke-dasharray="5,3"/>
    <rect x="552" y="308" width="90" height="15" rx="3" fill="#0e0f11"/>
    <text x="597" y="319" text-anchor="middle" fill="#e07b00" font-size="8.5" font-family="'DM Mono',monospace">Proceed anyway</text>

    <!-- 22: S7 → S2 (Adjust lots) -->
    <path d="M 761 317 L 761 370 L 450 370 L 450 317" stroke="#e07b00" stroke-width="1.5" fill="none" marker-end="url(#arr-w)" stroke-dasharray="5,3"/>
    <rect x="550" y="361" width="112" height="15" rx="3" fill="#0e0f11"/>
    <text x="606" y="372" text-anchor="middle" fill="#e07b00" font-size="8.5" font-family="'DM Mono',monospace">Adjust lots → S2</text>

    <!-- 12: S4 → S8 (Execute Wf-A) -->
    <path d="M 139 317 L 139 530" stroke="#3aaa5c" stroke-width="1.5" fill="none" marker-end="url(#arr-c)"/>
    <rect x="50" y="408" width="88" height="15" rx="3" fill="#0e0f11"/>
    <text x="94" y="419" text-anchor="middle" fill="#3aaa5c" font-size="8.5" font-family="'DM Mono',monospace">Execute Scen A</text>

    <!-- 13: S4 → S6 (Add Scenario) -->
    <path d="M 218 291 L 280 291 L 280 426 L 371 426" stroke="#9b72e8" stroke-width="1.5" fill="none" marker-end="url(#arr-x)"/>
    <rect x="238" y="375" width="88" height="15" rx="3" fill="#0e0f11"/>
    <text x="282" y="386" text-anchor="middle" fill="#9b72e8" font-size="8.5" font-family="'DM Mono',monospace">+ Add Scenario</text>

    <!-- 16: S5 → S6 (Add Scenario) -->
    <path d="M 450 317 L 450 400" stroke="#9b72e8" stroke-width="1.5" fill="none" marker-end="url(#arr-x)"/>
    <rect x="348" y="351" width="105" height="15" rx="3" fill="#0e0f11"/>
    <text x="400" y="362" text-anchor="middle" fill="#9b72e8" font-size="8.5" font-family="'DM Mono',monospace">+ Add Scenario</text>

    <!-- 15: S5 → S9 (Execute Wf-B) -->
    <path d="M 529 291 L 570 291 L 570 490 L 761 490 L 761 530" stroke="#2a8a58" stroke-width="1.5" fill="none" marker-end="url(#arr-c)"/>
    <rect x="616" y="478" width="88" height="15" rx="3" fill="#0e0f11"/>
    <text x="660" y="489" text-anchor="middle" fill="#2a8a58" font-size="8.5" font-family="'DM Mono',monospace">Execute Scen A</text>

    <!-- 17: S5 → S4 (See engine rec) -->
    <path d="M 371 278 L 218 278" stroke="#9b72e8" stroke-width="1" fill="none" marker-end="url(#arr-x)" stroke-dasharray="4,3"/>
    <rect x="250" y="268" width="80" height="15" rx="3" fill="#0e0f11"/>
    <text x="290" y="279" text-anchor="middle" fill="#9b72e8" font-size="8" font-family="'DM Mono',monospace">See engine rec</text>

    <!-- 19: S6 → S8 (Execute Scen A from comparison) -->
    <path d="M 371 426 L 310 426 L 310 510 L 218 510 L 218 556 L 218 556" stroke="#3aaa5c" stroke-width="1.5" fill="none" marker-end="url(#arr-c)" stroke-dasharray="5,3"/>
    <rect x="228" y="466" width="92" height="15" rx="3" fill="#0e0f11"/>
    <text x="274" y="477" text-anchor="middle" fill="#3aaa5c" font-size="8" font-family="'DM Mono',monospace">Execute Scen A</text>

    <!-- 20: S6 → S9 (Execute Scen B from comparison) -->
    <path d="M 529 426 L 620 426 L 620 510 L 682 510 L 682 556" stroke="#2a8a58" stroke-width="1.5" fill="none" marker-end="url(#arr-c)" stroke-dasharray="5,3"/>
    <rect x="568" y="466" width="94" height="15" rx="3" fill="#0e0f11"/>
    <text x="615" y="477" text-anchor="middle" fill="#2a8a58" font-size="8" font-family="'DM Mono',monospace">Execute Scen B</text>

    <!-- 23/24: S8 & S9 → S0 (Return to Portfolio) -->
    <path d="M 60 556 L 24 556 L 24 36 L 375 36" stroke="#383c47" stroke-width="1" fill="none" marker-end="url(#arr-back)" stroke-dasharray="4,3"/>
    <path d="M 840 556 L 876 556 L 876 36 L 525 36" stroke="#383c47" stroke-width="1" fill="none" marker-end="url(#arr-back)" stroke-dasharray="4,3"/>
    <text x="450" y="30" text-anchor="middle" fill="#555b68" font-size="8" font-family="'DM Mono',monospace">Return to Portfolio (both confirmation screens)</text>

    <!-- 04: S1 → S0 back (small) -->
    <!-- omitted for clarity — shown in table only -->

    <!-- 14: S4 → S1 back -->
    <path d="M 60 278 L 30 278 L 30 156 L 60 156" stroke="#383c47" stroke-width="1" fill="none" marker-end="url(#arr-back)" stroke-dasharray="3,3"/>

    <!-- 18: S5 → S2 back -->
    <path d="M 371 305 L 340 305 L 340 182 L 371 182" stroke="#383c47" stroke-width="1" fill="none" marker-end="url(#arr-back)" stroke-dasharray="3,3"/>

    <!-- S0 → S2 direct entry (Wf-B from Transact menu — implied, shown faint) -->
    <path d="M 450 102 L 450 130" stroke="#18b589" stroke-width="1" fill="none" marker-end="url(#arr-b)" stroke-dasharray="4,3" opacity="0.5"/>
    <rect x="460" y="108" width="86" height="14" rx="3" fill="#0e0f11" opacity="0.8"/>
    <text x="503" y="119" text-anchor="middle" fill="#18b589" font-size="7.5" font-family="'DM Mono',monospace" opacity="0.7">Transact menu (Wf-B)</text>

  </svg>
</div>

<!-- ── NOTES ── -->
<div style="margin-top:32px;display:grid;grid-template-columns:1fr 1fr;gap:16px;">
  <div style="background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:16px 18px;">
    <div style="font-family:var(--mono);font-size:9px;letter-spacing:0.14em;text-transform:uppercase;color:var(--text-dim);margin-bottom:10px;">Wiring Notes</div>
    <ul style="list-style:none;display:flex;flex-direction:column;gap:8px;">
      <li style="font-size:11px;color:var(--text-mid);padding-left:14px;position:relative;"><span style="position:absolute;left:0;color:var(--wf-x);">·</span> The S1 ↔ S2 Auto/Manual toggle and S2 ↔ S3 Table/Cards toggle are bidirectional — both directions need separate wires in Figma.</li>
      <li style="font-size:11px;color:var(--text-mid);padding-left:14px;position:relative;"><span style="position:absolute;left:0;color:var(--warn);">·</span> S7 is reached only via the ⏱ badge (S2 or S3), never via the "Analyze Scenario" footer button — those keep their existing wires to S5.</li>
      <li style="font-size:11px;color:var(--text-mid);padding-left:14px;position:relative;"><span style="position:absolute;left:0;color:var(--wf-x);">·</span> S5 → S4 ("See engine recommendation") is a cross-workflow link and should use a distinct visual treatment in Figma (e.g. "Navigate to" not "Push").</li>
      <li style="font-size:11px;color:var(--text-mid);padding-left:14px;position:relative;"><span style="position:absolute;left:0;color:var(--confirm);">·</span> S6 → S8/S9 execute wires are dashed in the diagram to indicate they duplicate the S4/S5 execute paths — same destination, different source.</li>
    </ul>
  </div>
  <div style="background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:16px 18px;">
    <div style="font-family:var(--mono);font-size:9px;letter-spacing:0.14em;text-transform:uppercase;color:var(--text-dim);margin-bottom:10px;">Wire Count Summary</div>
    <table style="width:100%;font-size:11px;border-collapse:collapse;">
      <tr><td style="padding:4px 0;color:var(--text-mid);">Workflow A primary path</td><td style="text-align:right;font-family:var(--mono);color:#7ab6f5;">5 wires</td></tr>
      <tr><td style="padding:4px 0;color:var(--text-mid);">Workflow B primary path</td><td style="text-align:right;font-family:var(--mono);color:#6de0b9;">6 wires</td></tr>
      <tr><td style="padding:4px 0;color:var(--text-mid);">Cross-workflow / toggles</td><td style="text-align:right;font-family:var(--mono);color:#c4a8f7;">7 wires</td></tr>
      <tr><td style="padding:4px 0;color:var(--text-mid);">Wait &amp; Save interrupt</td><td style="text-align:right;font-family:var(--mono);color:#f0b060;">4 wires</td></tr>
      <tr><td style="padding:4px 0;color:var(--text-mid);">Back / return navigation</td><td style="text-align:right;font-family:var(--mono);color:var(--text-dim);">5 wires</td></tr>
      <tr style="border-top:1px solid var(--border);">
        <td style="padding:8px 0 4px;font-weight:700;color:var(--text);">Total</td>
        <td style="text-align:right;font-family:var(--mono);font-weight:700;color:var(--text);padding-top:8px;">27 wires</td>
      </tr>
    </table>
  </div>
</div>

</body>
</html>
